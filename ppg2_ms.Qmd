---
title: "An update of the Pteridophyte Phylogeny Group classification for extant ferns and lycophytes: PPG II"
format:
  docx:
    reference-doc: template.docx
bibliography: references.yaml
link-bibliography: true
csl: taxon.csl
execute: 
  echo: false
  message: false
  warning: false
---

```{r}
#| label: setup
source(here::here("R/packages.R"))
source(here::here("R/functions.R"))
library(glue)
library(tidyverse)
library(assertr)
library(assertthat)
library(taxlist)
library(taxnames)
library(english)
library(knitr)
library(ggtree)
library(ggrepel)
library(ftolr)
library(patchwork)

conflicted::conflict_prefer("filter", "dplyr")

# Load targets
tar_load(
  c(
    ppg,
    commenters,
    children_tally,
    issues_count_plot,
    ppg_issues,
    ppg_issues_count,
    ppg_i_taxa_count,
    ppg_2_taxa_count,
    wf_taxa_count,
    voting_results,
    tree_fig,
    ppg_classification,
    uncertainty_table,
    references,
    template,
    ppg_i
  ),
  store = here::here("_targets")
)
```

Running title: PPG II

```{r}
#| label: load-names

auth_order <- tibble::tribble(
  ~name, ~order,
  "Joel H. Nitta", 1,
  "Michael Hassler", 2,
  "Harald Schneider", 3,
  "Carl J. Rothfels", 4,
  "Eric Schuettpelz", 5,
)

authors <- read_csv("data/ppg2_author_list.csv") |>
  left_join(auth_order, by = "name") |>
  mutate(
    last_name = map_chr(name, extract_last_name),
    last_name_order = case_when(
      name == "James E. Watkins, Jr." ~ "Watkins",
      name == "JuliÃ¡n Mostacero Giannangeli" ~ "Mostacero",
      .default = last_name
    )
  ) |>
  arrange(order, last_name_order) %>%
  assert(not_na, name, institution) |>
  assert(is_uniq, name) |>
  mutate(
    other_author = str_detect(
      name,
      "Hassler|Nitta|Rothfels|Schneider|Schuettpelz",
      negate = TRUE),
    institution_num = as.numeric(as.factor(fct_inorder(institution))),
    name_print = glue::glue("{name}^{institution_num}^"),
    inst_print = glue::glue("^{institution_num}^{institution}, {country}")
  )

other_authors <- 
  authors |>
  filter(other_author) |>
  pull(name_print) |>
  paste(collapse = ", ")

institutions <- 
  authors |>
  pull(inst_print) |>
  unique() |>
  paste(collapse = "\n")

```

Recommended citation: PPG II (2026). This project was organized by Joel H. Nitta\*^1^, Michael Hassler^2^, Harald Schneider^3^, Carl Rothfels^4^, and Eric Schuettpelz\*^5^; with additional contributions from (in alphabetical order): `r other_authors`

`r institutions`

\*Authors for correspondence

```{r}
#| label: abstract

# Format ppg2 taxon numbers for printing
n <- ppg_2_taxa_count |>
  select(taxonRank, ppg2 = accepted) |>
  left_join(
    select(ppg_i_taxa_count, taxonRank, ppg1 = accepted),
    by = "taxonRank"
  ) |>
  pivot_longer(
    names_to = "system",
    values_to = "n",
    c(ppg1, ppg2)
  ) |>
  mutate(
    n = case_when(
      n < 10 ~ as.character(english::english(n)),
      n >= 10 ~ scales::number(n, big.mark = ",")
    )
  ) %>%
  pivot_wider(names_from = system, values_from = n) %>%
  split(.$taxonRank)
```

## Acknowledgements

We thank the organizers of the XX International Botanical Congress (Madrid, 2024) and the Botany 2025 (Palm Springs, CA) conferences for hosting in-person meetings and workshops that were vital to developing this update.
We thank Alan Elliott and Roger Hyam for technical support in transitioning to the World Flora Online database, and World Flora Online for its cooperation and recognition of PPG as a TEN.

## Abstract

The most recent widely accepted classification for ferns and lycophytes is the Pteridophyte Phylogeny Group I classification (PPG I), published in 2016.
Since that time, many taxonomic revisions have been published and phylogenetic relationships have come into clearer focus.
Here, we present PPG II, an updated classification to reflect advances made in fern and lycophyte systematics since PPG I.
PPG II recognizes `r n$class$ppg2` classes, `r n$order$ppg2` orders, `r n$family$ppg2` families, `r n$genus$ppg2` genera, and `r n$species$ppg2` species of ferns and lycophytes.
Like PPG I, PPG II is the result of decisions made by a diverse community of pteridologists, but improvements have been made to increase transparency and efficiency, including posting all discussions on an openly available website and voting on taxonomic proposals on a rolling, monthly basis.
PPG II also extends the classification to the species level and includes nothogenera, neither of which were treated in PPG I.
Going forward, incremental updates to PPG II will be made online, obviating the lengthy delay between updated treatments.
The PPG II classification can be accessed on our website (<https://pteridogroup.github.io/ppg>) or World Flora Online (<https://www.worldfloraonline.org/>).

**Key words:** open science, nomenclature, phylogenetic systematics, taxonomy, World Flora Online

{{< pagebreak >}}

## Introduction

Ferns and lycophytes, which together compose the paraphyletic pteridophytes, are globally important plant groups that have shown remarkable resilience during their long phylogenetic history [@kenrick1997origin; @pryer2004phylogeny; @schneider2004ferns; @li2025fernsa].
Our understanding of fern and lycophyte relationships has been revolutionized by molecular methods, which demonstrated that horsetails (*Equisetum* L.) and whisk ferns (*Psilotum* Sw., *Tmesipteris* Bernh.) are nested within ferns and further that ferns are sister to seed plants and only distantly related to lycophytes [@pryer2001horsetails].
@smith2006classification published the first higher-level fern classification in the molecular era.
Two subsequent classifications extended the taxonomic scope to genera [@christenhusz2011linear; @christenhusz2014trends], but due in part to their drastic consolidation of genera and families they were not widely accepted by the broader pteridophyte community [@schuettpelz2018are].
The next widely accepted classification was Pteridophyte Phylogeny Group (PPG) I [-@pteridophytephylogenygroupi2016communityderived].
PPG I was remarkable for its community-based approach, which sought to obtain consensus among fern and lycophyte experts and included nearly 90 co-authors with global representation.

Since the publication of PPG I, phylogenetic relationships have been further clarified and taxonomic novelties have accrued.
Accordingly, the PPG community provides a revised taxonomic system for ferns and lycophytes, PPG II.

## Materials and Methods

To maximize participation in taxonomic discussions and ensure that justifications for taxonomic decisions were openly available, we implemented a system that is, to our knowledge, unique among taxonomic communities.
We briefly discuss this system below; technical details will be the focus of another publication.

### Taxonomic criteria

Our general criteria for approving taxonomic proposals remained unchanged from PPG I [-@pteridophytephylogenygroupi2016communityderived]: we sought to only recognize monophyletic groups (clades), while minimizing taxonomic disruption and maximizing usefulness (diagnosability).
Additionally, proposals were required to: (1) implement a change relative to PPG I [-@pteridophytephylogenygroupi2016communityderived]; (2) only include names that have been validly published and are legitimate under the International Code of Nomenclature for Algae, Fungi, and Plants [ICN\; @turland2025international]; (3) involve taxa at the genus level or higher.
The one exception to the second rule is in the case where nomenclatural conservation or rejection proposals are before the ICN.
Because such proposals may not be voted on by the Nomenclatural Committees of the ICN for several years, we allowed such names to be voted on and approved by PPG.
If a nomenclatural proposal is rejected, we will update the PPG classification accordingly.

### Discussion forum and voting

We set up a GitHub repository (<https://www.github.com/pteridogroup/ppg>) to solicit taxonomic proposals from the PPG community.
We used GitHub's "issue" functionality to track and discuss proposals; GitHub issues are normally used to track bugs during software development, but we found they also work well for managing taxonomic discussions.
We designed a custom issue template to ensure that all proposals included standard information such as the proposed taxon, number of affected species, reason for the change, and citations of relevant literature.
Anyone could submit a proposal provided it met the taxonomic criteria and they agreed to our Code of Conduct; proposals were then subject to an open discussion period of at least one month.
During this time, anyone who agreed to our Code of Conduct could comment on the proposal.

Following the discussion period, voting on proposals was conducted via Google Forms.
For each proposal, PPG members could choose to agree, disagree, or abstain.
Proposals receiving 2/3 agreement passed and were recognized by PPG.
All taxonomic discussions and results of voting are available for public access on our GitHub repository.
The proposal, discussion, and voting process ran continuously, with a ballot issued monthly.

### Database management

To curate taxonomic data, PPG has partnered with World Flora Online (WFO), a large-scale database project to provide a consensus taxonomy for all plants (<https://www.worldfloraonline.org/>).
World Flora Online relies on a network of taxonomic experts, called Taxonomic Expert Networks (TENs), to curate the taxonomy of specific plant groups [@borsch2020world].
PPG is the TEN for ferns and lycophytes.
As such, all taxonomic decisions made by PPG will also be reflected in WFO.

The database editor provided by WFO, called Rhakhis (<https://list.worldfloraonline.org/rhakhis/ui>), is taxonomy-aware---that is, it enforces taxonomic rules, for example, that synonyms must map to an accepted name and not another synonym---and provides full functionality for tracking synonymy relationships, publication and author data, and nomenclatural status, among other taxonomically relevant information.
Furthermore, Rhakhis is available as a live, web-based database, so PPG members can collaboratively edit the data in real time, with no need for synchronizing database files across multiple machines.

When PPG joined WFO as a TEN, data for ferns and lycophytes were already in Rhakhis, but the classification scheme was based on the World Checklist of Vascular Plants [@govaertsWorldChecklistVascular2021], which deviated largely from PPG I (2016).
Therefore, taxonomic data from the World Ferns database [@hassler2025world], which more closely followed PPG I [-@pteridophytephylogenygroupi2016communityderived], were imported into Rhakhis and synchronized with the existing data while prioritizing the World Ferns classification.
Finally, the data were further edited to reflect accepted taxonomic proposals from our voting process.
There will be ongoing data exchange between WFO/PPG and World Ferns.

### Extension to the species level

Another major change from PPG I is that the PPG II classification includes names at the rank of species and below (PPG I extended only to genus).
By using existing data in Rhakhis and World Ferns [@hassler2025world], PPG II was pre-populated with these lower-ranked taxa.
As changes to higher-ranked taxa were approved through our voting process, we moved taxa in Rhakhis at the level of species and below to the appropriate position in the revised classification.
Given that there are >13,000 accepted fern and lycophyte species names, it is not feasible to implement the same discussion and voting protocol that we applied to ranks at genus and above to ranks at species and below.
Instead, we have established committees of specialists (curators) who are responsible for reviewing and maintaining taxonomic data at the species level and below in Rhakhis for a particular taxon (or taxa), such that all taxa are accounted for.
When the World Ferns data [@hassler2025world] were imported into Rhakhis, not all species names could be successfully synchronized due to orthographic variation, resulting in differing numbers of accepted species between PPG II and World Ferns (@tbl-taxa).
One task of the PPG curators is to resolve these unmatched names.
Species-level curation will continue indefinitely with the publication of PPG II.

### Versioning

Starting with this version of the PPG classification (PPG 2.0.0), we are implementing a semantic versioning system, where the smallest digit indicates changes to the taxonomy at the species level or below, the middle digit indicates changes at the genus level or higher, and the largest digit indicates major changes (e.g., major rearrangements of the taxonomic hierarchy).
New versions will be issued as needed, for example following recognition of a new genus or if a specific version is needed to be cited by a project like the Fern Tree of Life [@nitta2022open].
We anticipate that updates (new versions) will be published much more frequently than the time that has elapsed between PPG I and PPG II.
This will benefit stakeholders who need an up-to-date, standardized taxonomy for ferns and lycophytes, while simultaneously providing, through the versioning system, the ability to unambiguously reference a specific snapshot of the classification.

### Code availability

All data and code used to generate this manuscript are available at <https://github.com/pteridogroup/ppg2-ms>.

## Results

```{r}
#| label: proposal-results
#| include: false

# Check that analysis of voting results matches issue status extracted
# from issue header
ppg_issues |>
  select(issue = number, state, status) |>
  left_join(
    voting_results,
    by = join_by(issue),
    relationship = "one-to-one"
  ) |>
  mutate(
    result = str_replace_all(result, "passes", "PASSED") |>
      str_replace_all("does not pass", "NOT PASSED"),
    result = tidyr::replace_na(result, "TBA")
  ) |>
  verify(all.equal(status, result), success_fun = success_logical)

# Summarize time period of submitted issues
# For month, add period only if abbreviated (not for May)
months_abb <- as.character(month(1:12, label = TRUE, abbr = TRUE))
months_full <- as.character(month(1:12, label = TRUE, abbr = FALSE))
months_abb_punc <- ifelse(months_abb == months_full, months_abb, paste0(months_abb, "."))

issues_time <-
  ppg_issues |>
  select(created_at) |>
  mutate(created_at = lubridate::ymd_hms(created_at)) |>
  summarize(
    min = min(created_at),
    max = max(created_at)
  ) |>
  mutate(
    min_year = year(min),
    min_month = months_abb_punc[month(min)],
    max_year = year(max),
    max_month = months_abb_punc[month(max)]
  )

# Count number of commenters per valid issue
comment_count <- commenters |>
  filter(!is.na(commenter)) |>
  group_by(issue) |>
  mutate(n_commenters = n_distinct(commenter)) |>
  # don't count if joelnitta was the only commenter
  # (standard announcement, not discussion)
  filter(!(commenter == "joelnitta" & n_commenters == 1)) |>
  ungroup() |>
  select(issue, n_commenters) |>
  unique() |>
  arrange(desc(n_commenters))

# Summarize voting stastics
n_issues_passed <- ppg_issues |>
  filter(str_detect(title, "\\[PASSED\\]")) |>
  nrow()

vote_stats <-
  voting_results |>
  filter(!is.na(result)) |>
  summarize(
    mean = round(mean(total_votes), 1),
    min = min(total_votes),
    max = max(total_votes)
  )

```

A total of `r nrow(ppg_issues)` valid proposals were made from `r issues_time$min_year` `r issues_time$min_month` to `r issues_time$max_year` `r issues_time$max_month`, of which `r n_issues_passed` were accepted and adopted into PPG II (@fig-voting).
Proposals averaged `r vote_stats$mean` votes (range `r vote_stats$min` to `r vote_stats$max`), and `r nrow(comment_count)` proposals featured a discussion among PPG members beyond the initial proposal itself or standard announcements such as voting results.

```{r}
#| label: results
#| include: false

# make sure n class, subclass, order, and suborder agree between
# ppg I and ppg II
ppg_2_higher <-
  ppg_2_taxa_count |>
  filter(taxonRank %in% c("class", "subclass", "order", "suborder")) |>
  select(taxonRank, accepted)

ppg_i_higher <-
  ppg_i_taxa_count |>
  filter(taxonRank %in% c("class", "subclass", "order", "suborder"))

assert_that(
  magrittr::equals(
    nrow(
      anti_join(ppg_i_higher, ppg_2_higher, by = join_by(taxonRank, accepted))
    ),
    0
  ),
  msg = "Number of higher taxa in PPG I and PPG II don't match"
)

```

The higher taxonomic levels of PPG II are largely unchanged relative to PPG I.
Two classes are recognized, Lycopodiopsida (lycophytes) and Polypodiopsida (ferns; @fig-tree).
These two classes are distinct lineages; ferns are more closely related to seed plants than they are to lycophytes [@kenrick1997origin; @pryer2004phylogeny; @schneider2004ferns].
However, lycophytes and ferns have historically been studied together as seed-free vascular plants and we continue in that tradition.
Our recognition of `r n$subclass$ppg2` subclasses, `r n$order$ppg2` orders, and `r n$suborder$ppg2` suborders is also unchanged from PPG I.

PPG II begins to diverge from PPG I at the level of family, where `r n$family$ppg2` families are recognized in PPG II versus `r n$family$ppg1` in PPG I (@tbl-taxa).
The number of subfamilies and genera is also greater in PPG II vs. PPG I (`r n$subfamily$ppg2` vs. `r n$subfamily$ppg1` and `r n$genus$ppg2` vs. `r n$genus$ppg1`, respectively).
Most taxonomic changes come via the addition of new names, i.e., splitting (@tbl-changes), whereas a smaller number of changes stems from the subsumption of existing names, i.e., lumping (@tbl-changes).
Another change is the recognition of `r n$nothogenus$ppg2` nothogenera, which were not treated in PPG I [-@pteridophytephylogenygroupi2016communityderived].
The resulting PPG II classification at the level of genus and above is presented below.

The number of taxa at the level of species and below (PPG II recognizes approximately 14,000 accepted species) precludes publishing those names here, but the full classification (extending to subspecific ranks) is available on our website (<https://pteridogroup.github.io/>) and WFO (<https://www.worldfloraonline.org/>).

## Discussion

### An open, community-based approach to taxonomy

PPG is unique in its open, community-based approach to taxonomy.
While other community efforts have been established [e.g., Legume Phylogeny Working Group\; @leroux2022experta], to our knowledge, no comparable classification working group exists that makes its discussions and results transparent and publicly available.
In addition, the non-hierarchical, inclusive nature of our approach reduces the risk of our taxonomic decisions being driven by a vocal minority.
It is our hope that this commitment to transparency and accessibility has resulted, and will continue to result, in a high-quality taxonomic classification that is widely used by stakeholders spanning a broad range of backgrounds, including researchers, conservationists, local botanists, curators, teachers, and others.

One clear benefit of the community approach is the ability to keep up with the rapid pace of systematics research.
We live in an age where data generation exceeds the ability of any individual to comprehensively track new insights across such a large and heterogeneous group as pteridophytes.
The community approach allows us to distribute the workload and stay abreast of the latest advances in the systematics of these plants, which we hope will lead to a continuously updated taxonomy that is maximally useful.

### Trends in pteridophyte classification

```{r}
nchild <- children_tally %>%
  split(.$taxon_name)
```

In comparison to PPG I, the general trend has been an increase in the number of genera (Figure S1).
This is driven primarily by a few (sub)families: Thelypteridaceae (`r nchild$Thelypteridaceae$n_genera` vs. `r count_ppgi_gen(ppg_i, family == "Thelypteridaceae")`), Grammitidoideae (`r nchild$Grammitidoideae$n_genera` vs. `r count_ppgi_gen(ppg_i, subfamily == "Grammitidoideae")`), and Cheilanthoideae (`r nchild$Cheilanthoideae$n_genera` vs. `r count_ppgi_gen(ppg_i, subfamily == "Cheilanthoideae")`).
Notable exceptions to the trend of splitting include the recognition of broadly construed *Lepisorus* and *Selliguea*, subsuming six and four genera, respectively, that were recognized in PPG I.

### Conclusion

The vast majority of taxa recognized herein are well established as monophyletic and were supported by a strong majority of voting members.
However, there are still areas of the classification that need resolution, and in some cases we recognize non-monophyletic taxa because no clear monophyletic option exists.
Known non-monophyletic taxa have been noted in the classification.
In addition, there are some relatively deep relationships that have still not been adequately resolved, as indicated by the dashed lines in @fig-tree and summarized in @tbl-uncertain.

One advantage of using rolling, monthly voting is that a taxonomic proposal may be submitted at any time, and proposals that did not pass may be revised and/or revisited in the future.
Furthermore, the classification can be updated and circulated online with much greater frequency than possible under a traditional print-based model, whereby only major updates are published.
This flexibility allows us to revisit taxonomic areas of uncertainty and revise them as soon as new data are available.

## Classification

Circumscriptions and synonymy are generally not shown, although we account for all names recognized in PPG I (2016); such names are listed as synonyms if not recognized herein.
A complete table of synonymy at the genus level and higher is provided in the Appendix.
Species counts exclude hybrids and should be considered approximate.
All taxa are considered monophyletic unless otherwise indicated.
Additional information can be found on the digital version of the classification at <https://pteridogroup.github.io> or at World Flora Online.

```{r}
#| label: ppg-treatment
#| results: asis

cat(ppg_classification, sep = "\n")
```

## Author Contributions

Joel H. Nitta organized monthly voting, wrote code used for importing data, and lead writing of the manuscript.
Michael Hassler provided taxonomic data.
Joel H. Nitta, Carl Rothfels, Harald Schneider, and Eric Schuettpelz served on the PPG organizing committee.
All authors participated by submitting and/or voting on taxonomic proposals and reviewed the manuscript.

## Literature cited

::: {#refs}
:::

## Tables

```{r}
#| label: tbl-taxa
#| tbl-cap: "Number of taxa in PPG II, PPG I [@pteridophytephylogenygroupi2016communityderived], and World Ferns [@hassler2025world] by taxonomic status
#|   (accepted or synonym).
#|   Species counts exclude hybrids and should be considered approximate.
#|   Complete synonymy was not presented in PPG I so this is not shown.
#|   Not every rank is used by every treatment.
#|   \\*Curation of species-level data in PPG II is ongoing, so this number is approximate."

ppg_2_taxa_count |>
  full_join(
    select(
      ppg_i_taxa_count,
      taxonRank,
      ppgi_accepted = accepted
    ),
    by = "taxonRank"
  ) |>
  full_join(
    wf_taxa_count,
    by = "taxonRank"
  ) |>
  mutate(
    taxonRank = str_to_sentence(taxonRank),
    across(where(is.integer)|where(is.numeric), ~ replace_na(., 0)),
    across(where(is.integer)|where(is.numeric), ~ scales::number(., big.mark = ",")),
    across(
      c(accepted, ppgi_accepted, wf_accepted, wf_synonym),
      ~ str_replace_all(., "^0$", "not used")),
    accepted = case_when(
      taxonRank == "Species" ~ paste0(accepted, "\\*"),
      .default = accepted
    ),
    synonym = case_when(
      taxonRank == "Species" ~ paste0(synonym, "\\*"),
      .default = synonym
    )
  ) |>
  select(
    Rank = taxonRank,
    `PPG II (accepted)` = accepted,
    `PPG II (synonym)` = synonym,
    `PPG I (accepted)` = ppgi_accepted,
    `World Ferns (accepted)` = wf_accepted,
    `World Ferns (synonym)` = wf_synonym
  ) |>
  knitr::kable()
```

```{r}
#| label: tbl-changes
#| tbl-cap: "Count of taxonomic changes in PPG II vs. PPG I by rank, with
#|   the effect on the total number of taxa in each rank brought about by each
#|   change. Types of change include conserve: conserves one
#|   name over another; sink: subsumes one taxon into another; split: recognizes
#|   a new taxon; transfer: moves a taxon into a different position in the
#|   hierarchy."

ppg_issues_count |>
  filter(change != "none") |>
  mutate(rank = factor(rank, levels = c("Family", "Subfamily", "Genus", "Nothogenus"))) |>
  count(rank, change) |>
  mutate(effect = case_when(
    change %in% c("conserve", "expand", "shrink", "transfer") ~ "none",
    change == "sink" ~ "decrease",
    change == "split" ~ "increase",
  )) |>
  filter(
    change %in% c("conserve", "sink", "split", "transfer")
  ) |>
  mutate(
    change = str_to_sentence(change),
    effect = str_to_sentence(effect)
  ) |>
  arrange(rank, change) |>
  select(
    Rank = rank,
    Change = change,
    Effect = effect,
    n = n
  ) |>
  knitr::kable()
```

```{r}
#| label: tbl-uncertain
#| tbl-cap: "Uncertain relationships in pteridophytes. Node indicates numbered
#|   nodes in Fig. 1."
knitr::kable(uncertainty_table)
```

## Figures

```{r}
#| label: fig-voting
#| fig-width: 6.5
#| fig-height: 5
#| fig-cap: "Cumulative count (A) and monthly voting results (B) of taxonomic proposals
#|   submitted by PPG community members for PPG II."
ggsave(
  plot = issues_count_plot,
  width = 6.5,
  height = 5,
  units = "in",
  file = "fig_1.pdf"
)

issues_count_plot
```

```{r}
#| label: fig-tree-caption

fig_tree_cap <- glue::glue("
  Summary cladogram showing relationships between families of tracheophytes recognized by PPG II.
  Topology for Polypodiopsida modified from Fern Tree of Life (FTOL) v{ft_data_ver()} [@nitta2022open].
  Numbers next to each family indicate number of genera followed by number of species.
  Size of diamonds at tips indicate relative number of species in each family.
  Numbers at nodes indicate uncertain relationships, summarized in Table 3.
  @nitta2022open recovered Salviniales sister to Cyatheales, but this has generally not been observed in other studies [e.g., @schuettpelz2007fern; @testo20164000species; @rothfels2015evolutionary; @du2022structural], so the consensus topology is shown instead.
  ") |>
  as.character() |>
  str_remove_all("//\n") |>
  str_squish()

```

```{r}
#| label: fig-tree
#| fig-width: 6.5
#| fig-height: 9
#| fig-cap: !expr 'fig_tree_cap'

ggsave(
  plot = tree_fig,
  width = 6.5,
  height = 8.5,
  units = "in",
  file = "fig_2.pdf"
)

tree_fig
```
